/* 3D spinner carousel plugin - see https://github.com/andysellick/spinner for details */
!function(t,i){var e=function(t,e){this.elem=t,this.$elem=i(t),this.options=e,this.zindexes=[]};e.prototype={init:function(){var e=this,s=10;if(this.settings=i.extend({middleslidewidth:40,spinnerheight:0,animspeed:500,disableat:767,linkBtn:1,linkBtnClass:"btn btn-large",linkBtnText:"View",nav:1,navNextText:"Next",navPrevText:"Previous"},this.defaults,this.options),i(t).on("resize",function(){var s=e.$elem.find(".spinner");i(t).width()<e.settings.disableat?s.hasClass("active")&&e.destroy():s.hasClass("active")||e.init(),e.setSpinnerHeight()}),i(t).width()>this.settings.disableat){var n=this.$elem.find(".spinner");n.addClass("active");var a=n.find("li"),d=a.length,h=Math.floor(d/2),r=0,l=10,o=10,c=0;a.each(function(){i(this).addClass(h>r?"left":r>h?"right":"middle"),r++,i("<span/>").addClass("mask js-control active").appendTo(i(this)),i(this).find("img").addClass("image"),e.zindexes[c]=d/2>=c?l*(c+1):e.zindexes[c-1]-o,c++});var f=i("<div/>").addClass("spinnernav").appendTo(this.$elem);this.settings.nav&&i("<a/>").addClass("js-control next active").html(this.settings.navPrevText).attr("data-dir","prev").attr("title",this.settings.navPrevText).appendTo(f),this.settings.linkBtn&&i("<a/>").addClass("action").addClass(this.settings.linkBtnClass).html(this.settings.linkBtnText).attr("href",this.$elem.find(".middle > a").attr("href")).appendTo(f),this.settings.nav&&i("<a/>").addClass("js-control prev active").html(this.settings.navNextText).attr("data-dir","next").attr("title",this.settings.navNextText).appendTo(f);var p=0,v=0,m=1*s,g=(100-this.settings.middleslidewidth)/2,x=g/h,u=(55+x*(h-1))/h;n.find(".left").each(function(){e.setupAttributes(i(this),p,v,u,m),p+=x,v+=x,m+=1*s});var w=m;m-=1*s,v-=10,p=100-p-(u-x),n.find(".right").each(function(){e.setupAttributes(i(this),p,v,u,m),p+=x,v-=x,m-=1*s}),n.find(".middle").css({top:0,left:g+"%","z-index":w,width:this.settings.middleslidewidth+"%"}),this.$elem.on("click",".js-control.active",function(t){t.preventDefault(),i(".js-control").removeClass("active");var n,a=0;i(this).attr("data-dir")?(n=i(this).attr("data-dir"),a=1):(a=i(this).closest("li").index(),a>h?(a-=h,n="next"):h>a?(a=h-a,n="prev"):a=0),e.triggerAnimation(a,n,s)}),e.setSpinnerHeight()}return this},setSpinnerHeight:function(){var t=this.settings.spinnerheight;t||(t=this.$elem.find(".spinner").find(".middle").outerHeight(!0)),this.$elem.find(".spinner").css("height",t)},setupAttributes:function(t,i,e,s,n){t.css({left:i+"%",top:e+"%",width:s+"%","z-index":n})},destroy:function(){var t=this.$elem.find(".spinner");t.removeClass("active").css("height","auto"),this.$elem.unbind("click"),this.$elem.find(".spinnernav").remove(),t.find("li").each(function(){i(this).attr("class","").css({left:"",top:"",width:"","z-index":""})}),t.find(".mask").remove(),t.find(".image").css({opacity:"",transform:""})},triggerAnimation:function(t,e,s){t?this.animateSlide(t,e,s):i(".js-control").addClass("active")},hackZindexes:function(){var t=this,e=this.$elem.find(".spinner"),s=e.find("li");s.each(function(){i(this).css("z-index",t.zindexes[s.index(i(this))])})},animateSlide:function(t,e,s){var n=this.$elem.find(".spinner"),a=n.find("li");"next"==e&&(a=i(n.find("li").get().reverse()));var d=this,h=1;a.each(function(){var r,l=0;h&&(h=0,"next"==e?n.find("li").first().appendTo(n):n.find("li").last().prependTo(n)),"next"==e?(l=a.length-i(this).index()-1,r=l<a.length-1?i(this).prev():n.find("li").last()):(l=i(this).index(),r=l<a.length-1?i(this).next():n.find("li").first());var o=r.attr("class"),c=r.css("left"),f=r.css("top"),p=r.css("width"),v=d.$elem.width()/100;c=parseInt(c.split("px"))/v+"%",p=parseInt(p.split("px"))/v+"%",i(this).attr("data-pos",l),d.hackZindexes(),i(this).attr("class",o).animate({left:c,top:f,width:p},d.settings.animspeed,"swing",function(){parseInt(i(this).attr("data-pos"))==a.length-1&&(d.hackZindexes(),t--,d.triggerAnimation(t,e,s)),d.settings.linkBtn&&d.$elem.find(".action").attr("href",d.$elem.find(".middle > a").attr("href"))})})}},i.fn.spinner=function(t){return this.each(function(){new e(this,t).init()})},t.Plugin=e}(window,jQuery);