/* 3D spinner carousel plugin - see https://github.com/andysellick/spinner for details */
!function(t,i){var e=function(t,e){this.elem=t,this.$elem=i(t),this.options=e,this.zindexes=[]};e.prototype={init:function(){var n=this,s=10;if(this.settings=i.extend({middleslidewidth:40,spinnerheight:0,animspeed:500,disableat:767,linkBtn:1,linkBtnClass:"btn btn-large",linkBtnText:"View",nav:1,navNextText:"Next",navPrevText:"Previous"},this.defaults,this.options),i(t).on("resize",function(){var e=n.$elem.find(".spinner");i(t).width()<n.settings.disableat?e.hasClass("active")&&n.destroy():e.hasClass("active")||n.init(),n.setSpinnerHeight()}),i(t).width()>this.settings.disableat){var a=this.$elem.find(".spinner");a.addClass("active");var d=a.find("li"),r=d.length,h=Math.floor(r/2),l=0,o=10,f=10,c=0;d.each(function(){i(this).addClass(h>l?"left":l>h?"right":"middle"),l++,i("<span/>").addClass("mask js-control active").appendTo(i(this)),i(this).find("img").addClass("image"),n.zindexes[c]=r/2>=c?o*(c+1):n.zindexes[c-1]-f,c++});var p=i("<div/>").addClass("spinnernav").appendTo(this.$elem);if(this.settings.nav){i("<a/>").addClass("js-control next active").html(this.settings.navPrevText).attr("data-dir","prev").attr("title",this.settings.navPrevText).appendTo(p)}if(this.settings.linkBtn){i("<a/>").addClass("action").addClass(this.settings.linkBtnClass).html(this.settings.linkBtnText).attr("href",this.$elem.find(".middle > a").attr("href")).appendTo(p)}if(this.settings.nav){i("<a/>").addClass("js-control prev active").html(this.settings.navNextText).attr("data-dir","next").attr("title",this.settings.navNextText).appendTo(p)}var v=0,g=0,m=1*s,x=(100-this.settings.middleslidewidth)/2,u=x/h,w=(55+u*(h-1))/h;a.find(".left").each(function(){e.prototype.setupAttributes(i(this),v,g,w,m),v+=u,g+=u,m+=1*s});var C=m;m-=1*s,g-=10,v=100-v-(w-u),a.find(".right").each(function(){e.prototype.setupAttributes(i(this),v,g,w,m),v+=u,g-=u,m-=1*s}),a.find(".middle").css({top:0,left:x+"%","z-index":C,width:this.settings.middleslidewidth+"%"}),this.$elem.on("click",".js-control.active",function(t){t.preventDefault(),i(".js-control").removeClass("active");var e,a=0;i(this).attr("data-dir")?(e=i(this).attr("data-dir"),a=1):(a=i(this).closest("li").index(),a>h?(a-=h,e="next"):h>a?(a=h-a,e="prev"):a=0),n.triggerAnimation(a,e,s)}),n.setSpinnerHeight()}return this},setSpinnerHeight:function(){var t=this.settings.spinnerheight;t||(t=this.$elem.find(".spinner").find(".middle").outerHeight(!0)),this.$elem.find(".spinner").css("height",t)},setupAttributes:function(t,i,e,n,s){t.css({left:i+"%",top:e+"%",width:n+"%","z-index":s})},destroy:function(){var t=this.$elem.find(".spinner");t.removeClass("active").css("height","auto"),this.$elem.unbind("click"),this.$elem.find(".spinnernav").remove(),t.find("li").each(function(){i(this).attr("class","").css({left:"",top:"",width:"","z-index":""})}),t.find(".mask").remove(),t.find(".image").css({opacity:"",transform:""})},triggerAnimation:function(t,e,n){t?this.animateSlide(t,e,n):i(".js-control").addClass("active")},hackZindexes:function(){var t=this,e=this.$elem.find(".spinner"),n=e.find("li");n.each(function(){i(this).css("z-index",t.zindexes[n.index(i(this))])})},animateSlide:function(t,e,n){{var s=this.$elem.find(".spinner"),a=s.find("li");a.length}"next"==e&&(a=i(s.find("li").get().reverse()));var d=this,r=1;a.each(function(){var h,l=0;r&&(r=0,"next"==e?s.find("li").first().appendTo(s):s.find("li").last().prependTo(s)),"next"==e?(l=a.length-i(this).index()-1,h=l<a.length-1?i(this).prev():s.find("li").last()):(l=i(this).index(),h=l<a.length-1?i(this).next():s.find("li").first());var o=h.attr("class"),f=h.css("left"),c=h.css("top"),p=h.css("width"),v=d.$elem.width()/100;f=parseInt(f.split("px"))/v+"%",p=parseInt(p.split("px"))/v+"%",i(this).attr("data-pos",l),d.hackZindexes(),i(this).attr("class",o).animate({left:f,top:c,width:p},d.settings.animspeed,"swing",function(){parseInt(i(this).attr("data-pos"))==a.length-1&&(d.hackZindexes(),t--,d.triggerAnimation(t,e,n)),d.settings.linkBtn&&d.$elem.find(".action").attr("href",d.$elem.find(".middle > a").attr("href"))})})}},i.fn.spinner=function(t){return this.each(function(){new e(this,t).init()})},t.Plugin=e}(window,jQuery);